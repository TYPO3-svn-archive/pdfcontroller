includeLibs.user_tx_pdfcontroller = EXT:pdfcontroller/lib/class.user_tx_pdfcontroller.php

plugin.tx_pdfcontroller_pi2 {
  button = IMAGE
  button {
    wrap = |&nbsp;
    file = ###IMAGEFILE###
    altText = TEXT
    altText {
      value = Download content as PDF file
      lang {
        de = Inhalt als PDF-Datei herunterladen
      }
    }
    titleText < .altText
    imageLinkWrap = 1
    imageLinkWrap {
      enable = 1
      typolink {
        parameter         = ###PARAMETER###
        additionalParams  = ###ADDITIONALPARAMS###
        ATagParams        = rel="nofollow"
      }
    }
  }
  flexform {
    sDEF {
        // Path to the image file with the PDF icon
      imagefile = TEXT
      imagefile {
        value = EXT:pdfcontroller/res/images/pdf.png
      }
    }
  }
  master_templates {
    pdf_and_print_button = COA
    pdf_and_print_button {
      wrap = <div class="tx-pdfcontroller-pi2"><ul> | </ul></div>
        // PDF icon
      10 = COA
      10 {
        wrap = <li>|</li>
          // Open the a-tag with href
        10 = TEXT
        10 {
          typolink {
            parameter  = {$plugin.tx_pdfcontroller_pi2.page.pdf_controller}
            ATagParams = rel="nofollow"
            returnLast = url
          }
          wrap = <a href="|
        }
          // Add additional parameters to the href
        20 = TEXT
        20 {
          value = ?tx_pdfcontroller_pi1[URL]=
        }
        22 = TEXT
        22 {
          wrap          = %26|
          data          = getIndpEnv:TYPO3_REQUEST_URL
          rawUrlEncode  = 1
        }
        23 = TEXT
        23 {
          wrap          = %26|
          data          = {$plugin.tx_pdfcontroller_pi2.typeNum.print}
          rawUrlEncode  = 1
        }
        24 = TEXT
        24 {
          value = ">
        }
          // Label of the a-tag 
        30 = IMAGE
        30 {
          file = typo3conf/ext/pdfcontroller/res/images/pdf.png
          altText = TEXT
          altText {
            value = Download content as PDF file
            lang {
              de = Inhalt als PDF-Datei herunterladen
            }
          }
          titleText < .altText
        }
          // Close the a-tag
        40 = TEXT
        40 {
          wrap = |</a>
        }
      }
        // Print icon
      20 = IMAGE
      20 {
        wrap = <li>|</li>
        file = typo3conf/ext/pdfcontroller/res/images/printer.png
        altText = TEXT
        altText {
          value = Optimized printing
          lang {
            de = Optimierter Druck
          }
        }
        titleText < .altText
        imageLinkWrap = 1
        imageLinkWrap {
          enable = 1
          typolink {
            parameter = {page:uid},{$plugin.tx_pdfcontroller_pi2.typeNum.print}
            parameter {
              insertData = 1
            }
            addQueryString  = 1
            addQueryString {
              exclude = id
            }
            ATagParams      = rel="nofollow"
          }
        }
      }
    }
    add_parameter {
        // Parameter of mm_forum plugin 1
      tx_mmforum_pi1 = COA
      tx_mmforum_pi1 {
          // fid
        10 = TEXT
        10 {
          dataWrap        = &tx_mmforum_pi1[fid]={GP:tx_mmforum_pi1|fid}
          if.isTrue.data  = GPvar:tx_mmforum_pi1|fid
        }
          // tid
        20 = TEXT
        20 {
          dataWrap        = &tx_mmforum_pi1[tid]={GP:tx_mmforum_pi1|tid}
          if.isTrue.data  = GPvar:tx_mmforum_pi1|tid
        }
          // quote
        30 = TEXT
        30 {
          dataWrap        = &tx_mmforum_pi1[quote]={GP:tx_mmforum_pi1|quote}
          if.isTrue.data  = GPvar:tx_mmforum_pi1|quote
        }
          // page
        40 = TEXT
        40 {
          dataWrap        = &tx_mmforum_pi1[page]={GP:tx_mmforum_pi1|page}
          if.isTrue.data  = GPvar:tx_mmforum_pi1|page
        }
          // pid
        50 = TEXT
        50 {
          dataWrap        = &tx_mmforum_pi1[pid]={GP:tx_mmforum_pi1|pid}
          if.isTrue.data  = GPvar:tx_mmforum_pi1|pid
        }
      }
    }
  }
  _CSS_DEFAULT_STYLE (
    .tx-pdfcontroller-pi2 {
      text-align: right;
    }
    .tx-pdfcontroller-pi2 ul {
      font-weight: bold;
      list-style-type: none;
      margin: 0;
      padding: 0;
    }
    .tx-pdfcontroller-pi2 ul li {
      display:inline;
      margin: 0;
      padding-left:.6em;
    }
  )
}